/*!
 * gif.js ver 0.8.1 (2020-06-10)
 * (c) katwat (katwat.s1005.xrea.com)
 * based on http://slbkbs.org/jsgif/
 * The MIT License
 */
!function(){function f(t){var e=document.createElement('canvas');return e.width=t.width,e.height=t.height,e.getContext('2d').putImageData(t,0,0),e}function t(){this.header=null,this.blocks=null,this.backgroundColor=new Uint8Array(new ArrayBuffer(4))}var c,e;Gif=(c=function(){var t,s=33,o=44,h=59,c=249,l=254,d=1,u=255,r=this;function p(t){this.data=new DataView(t),this.pos=0}function i(t,e){for(var r=[];e--;)r.push(t.readBytes(3));return r}function f(t){var e;if('GIF'!==t.readString(3))throw new Error('not gif');this.ver=t.readString(3),this.width=t.readUint16(),this.height=t.readUint16(),e=t.readUint8(),this.gctSize=7&e,e>>>=3,this.sorted=1&e,e>>>=1,this.colorRes=7&e,e>>>=3,this.gctFlag=1&e,this.bg=t.readUint8(),this.pixelAspectRatio=t.readUint8(),this.gctFlag?this.gct=i(t,1<<this.gctSize+1):this.gct=null}function n(t){for(var e,r,i,n,a=new Uint8Array(0);0<(e=t.readUint8());)r=a,i=t.readBytes(e),n=void 0,(n=new Uint8Array(r.length+i.length)).set(r),n.set(i,r.length),a=n;return a}function g(t){var e;this.blockType=s,this.extType=c,t.readUint8(),e=t.readUint8(),this.transparencyGiven=1&e,e>>>=1,this.userInput=1&e,e>>>=1,this.disposalMethod=7&e,e>>>=3,this.delayTime=t.readUint16(),this.transparencyIndex=t.readUint8(),t.readUint8()}function y(t){this.blockType=s,this.extType=l,this.comment=n(t)}function w(t){this.blockType=s,this.extType=d,this.ptHeader=t.readBytes(t.readUint8()),this.ptData=n(t)}function U(t){switch(this.blockType=s,this.extType=u,t.readUint8(),this.identifier=t.readString(8),this.authCode=t.readString(3),this.identifier){case'NETSCAPE':t.readUint8(),t.readUint8(),this.iterations=t.readUint16(),t.readUint8();break;default:this.appData=n(t)}}function b(t,e){this.blockType=s,this.extType=e,this.data=n(t)}function a(e,i){for(var r,t,n,a=0,s=[],o=1<<e,h=o+1,c=e+1;;)if(n=t,(t=function(t){var e,r=0;for(e=0;e<t;e++)i[a>>>3]&1<<(7&a)&&(r|=1<<e),a++;return r}(c))!==o){if(t===h)break;if(t<r.length)n!==o&&r.push(r[n].concat(r[t][0]));else{if(t!==r.length)throw new Error('Invalid LZW code');r.push(r[n].concat(r[n][0]))}s.push.apply(s,r[t]),r.length===1<<c&&c<12&&c++}else!function(){var t;for(r=new Array(h+1),c=e+1,t=0;t<o;t++)r[t]=[t];r[o]=[],r[h]=null}();return new Uint8Array(s)}function v(a,s){for(var t,o=new Uint8Array(a.length),e=a.length/s,r=[0,4,2,1],i=[8,8,4,2],n=0,h=0;h<4;h++)for(t=r[h];t<e;t+=i[h])!function(t,e){var r,i,n;for(r=e*s,i=t*s,n=0;n<s;n++)o[i+n]=a[r+n]}(t,n),n++;return o}function m(t,e){var r;this.blockType=o,this.gce=e,this.left=t.readUint16(),this.top=t.readUint16(),this.width=t.readUint16(),this.height=t.readUint16(),r=t.readUint8(),this.lctSize=7&r,r>>>=3,r>>>=2,this.sorted=1&r,r>>>=1,this.interlaced=1&r,r>>>=1,this.lctFlag=1&r,this.lctFlag?this.lct=i(t,1<<this.lctSize+1):this.lct=null,this.pixels=a(t.readUint8(),n(t)),this.interlaced&&(this.pixels=v(this.pixels,this.width)),k(t.pos,t.data.buffer.byteLength)}function k(t,e){r.postMessage({type:'progress',progress:{loaded:t,total:e}})}this.onmessage=function(t){var e;if('parse'===(t=t.data).type)try{e=function(t){var e,r,i,n,a;e=new p(t),n=new f(e),a=[],i=null;for(;r=function(t,e){switch(t.readUint8()){case s:return function(t){var e=t.readUint8();switch(e){case c:return new g(t);case l:return new y(t);case d:return new w(t);case u:return new U(t);default:return new b(t,e)}}(t);case o:return new m(t,e);case h:return null;default:throw new Error('unknown block')}}(e,i);)r.blockType===s&&r.extType===c&&(i=r),a.push(r);return k(e.pos,e.data.buffer.byteLength),{header:n,blocks:a}}(t.buf),this.postMessage({type:'parse',result:e})}catch(t){this.postMessage({type:'error',error:t.toString()})}},(t=p.prototype).readUint8=function(){var t=this.pos;return this.pos+=1,this.data.getUint8(t)},t.readUint16=function(){var t=this.pos;return this.pos+=2,this.data.getUint16(t,!0)},t.readBytes=function(t){var e=this.pos;return this.pos+=t,new Uint8Array(this.data.buffer,e,t)},t.readString=function(t){return String.fromCharCode.apply(void 0,this.readBytes(t))}},(e=t.prototype).parse=function(t,e,r,i){var n,a=this,s=(n=c.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1],URL.createObjectURL(new Blob([n],{type:'application/javascript'}))),o=new Worker(s);function h(){o.terminate(),URL.revokeObjectURL(s)}o.onmessage=function(t){switch((t=t.data).type){case'parse':a.header=t.result.header,a.blocks=t.result.blocks,h(),e(a);break;case'error':h(),r&&r(t.error);break;case'progress':i&&i(t.progress)}},o.postMessage({type:'parse',buf:t},[t])},e.createFrameImage=function(t,e,r){var i,n,a,s,o,h,c=t.createImageData(e.width,e.height),l=c.data,d=this.header.gct,u=e.lctFlag?e.lct:d,p=e.gce;for(p&&p.transparencyGiven&&(i=p.transparencyIndex),a=(n=e.pixels).length,s=0;s<a;s++)(o=n[s])!==i&&(o=u[o],l[h=s<<2]=o[0],l[1+h]=o[1],l[2+h]=o[2],l[3+h]=255);return r?f(c):c},e.createFrameImages=function(e,r,i){var n,a,s,o,h,c,l,d;return this.blocks?(a=[],(n=this).blocks.forEach(function(t){44===t.blockType&&a.push({delay:t.gce?t.gce.delayTime:0,disposalMethod:t.gce?t.gce.disposalMethod:0,left:t.left,top:t.top,image:n.createFrameImage(e,t,r||i)})}),r&&(s=this.header.width,o=this.header.height,(h=document.createElement('canvas')).width=s,h.height=o,(h=h.getContext('2d')).fillStyle='rgba('+this.backgroundColor[0]+','+this.backgroundColor[1]+','+this.backgroundColor[2]+','+this.backgroundColor[3]/255+')',h.fillRect(0,0,s,o),c=0,a.forEach(function(t){2!==c&&3!==c||(h.clearRect(0,0,s,o),h.fillRect(0,0,s,o)),3===c&&l&&h.drawImage(l.image,l.left,l.top),h.drawImage(t.image,t.left,t.top),1===t.disposalMethod&&(l={image:t.image,left:t.left,top:t.top}),c=t.disposalMethod,d=h.getImageData(0,0,s,o),t.image=i?f(d):d,t.left=0,t.top=0})),a):null},t)}();